{"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/FZUIKit\/documentation\/FZUIKit\/AppKit\/NSImage\/preparingForDisplay()"},"schemaVersion":{"major":0,"minor":3,"patch":0},"metadata":{"modules":[{"relatedModules":["AppKit"],"name":"FZUIKit"}],"fragments":[{"kind":"keyword","text":"func"},{"text":" ","kind":"text"},{"kind":"identifier","text":"preparingForDisplay"},{"text":"() -> ","kind":"text"},{"text":"NSImage","kind":"typeIdentifier","preciseIdentifier":"c:objc(cs)NSImage"},{"text":"?","kind":"text"}],"roleHeading":"Instance Method","extendedModule":"AppKit","role":"symbol","title":"preparingForDisplay()","externalID":"s:So7NSImageC7FZUIKitE19preparingForDisplayABSgyF","symbolKind":"method"},"hierarchy":{"paths":[["doc:\/\/FZUIKit\/documentation\/FZUIKit","doc:\/\/FZUIKit\/documentation\/FZUIKit\/AppKit","doc:\/\/FZUIKit\/documentation\/FZUIKit\/AppKit\/NSImage"]]},"abstract":[{"text":"Decodes an image synchronously and provides a new one for display in views and animations.","type":"text"}],"kind":"symbol","primaryContentSections":[{"declarations":[{"languages":["swift"],"platforms":["macOS"],"tokens":[{"kind":"keyword","text":"func"},{"text":" ","kind":"text"},{"text":"preparingForDisplay","kind":"identifier"},{"kind":"text","text":"() -> "},{"preciseIdentifier":"c:objc(cs)NSImage","kind":"typeIdentifier","text":"NSImage"},{"text":"?","kind":"text"}]}],"kind":"declarations"},{"kind":"content","content":[{"text":"Return Value","type":"heading","level":2,"anchor":"return-value"},{"type":"paragraph","inlineContent":[{"text":"A new version of the image object for display. If the system can’t decode the image, this method returns nil.","type":"text"}]}]},{"content":[{"anchor":"discussion","level":2,"type":"heading","text":"Discussion"},{"inlineContent":[{"text":"The Animation Hitches instrument measures system performance for multiple stages of preparing views for display. It can show you the exact cause of an animation hitch, which appears to the user as an interruption or jump in an animation that should be smooth. If Animation Hitches indicates that decoding an image takes too long and causes hitches, use this method to move the decoding work to the background. For more information on using Instruments, see Instruments Help.","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"Avoid using this method on the main thread unless you previously started preparing an image with prepareForDisplay(completionHandler:). If you’re decoding many images, such as with a collection view, calling this method from a concurrent queue can degrade performance by demanding too many system threads. Use a serial queue instead.","type":"text"}]},{"inlineContent":[{"type":"text","text":"This method returns a new image object for efficient display by an image view. Assign the image object created by this method to the image property of the image view. If NSImageView can render the image without decoding, this method returns a valid image without further processing. If the system can’t decode the image, such as an image created from a CIImage, the method returns nil."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"AppKit doesn’t associate the prepared image with the original, or with any related variants from an asset catalog. If your app environment dynamically changes display traits, listen for changes in the trait environment and prepare new images when the environment changes."}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["func collectionView(_ collectionView: NSCollectionView, willDisplay item: NSCollectionViewItem, forRepresentedObjectAt indexPath: IndexPath) {","    guard let imageItem = item as? ImageItem else {","        fatalError(\"Expected `\\(ImageItem.self)` type for reuseIdentifier \\(reuseIdentifier). Check the configuration in Main.storyboard.\")","    }","    let item = models[indexPath.item]","    if let image = preparedImageCache.object(forKey: item.id), imageItem.itemIdentifier == item.id {","        \/\/ Use a cached prepared image.","       imageItem.imageView.image = image","    } else {","        \/\/ If the data source didn't prefetch the item, prepare the image on a serial dispatch queue.","        serialQueue.async { [weak preparedImageCache, placeholderImage] in","            item.loadAsset()","            let preparedImage: NSImage = item.image.preparingForDisplay() ?? placeholderImage","            preparedImageCache?.setObject(preparedImage, forKey: item.id)","            DispatchQueue.main.async {","                if imageItem.itemIdentifier == item.id {","                   imageItem.imageView.image = preparedImage","                }","            }","        }","    }","}"]}],"kind":"content"}],"sections":[],"variants":[{"paths":["\/documentation\/fzuikit\/appkit\/nsimage\/preparingfordisplay()"],"traits":[{"interfaceLanguage":"swift"}]}],"references":{"doc://FZUIKit/documentation/FZUIKit":{"type":"topic","role":"collection","identifier":"doc:\/\/FZUIKit\/documentation\/FZUIKit","title":"FZUIKit","kind":"symbol","abstract":[],"url":"\/documentation\/fzuikit"},"doc://FZUIKit/documentation/FZUIKit/AppKit":{"type":"topic","role":"collection","identifier":"doc:\/\/FZUIKit\/documentation\/FZUIKit\/AppKit","title":"AppKit","kind":"symbol","abstract":[],"url":"\/documentation\/fzuikit\/appkit"},"doc://FZUIKit/documentation/FZUIKit/AppKit/NSImage":{"role":"symbol","fragments":[{"text":"extension","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","preciseIdentifier":"c:objc(cs)NSImage","text":"NSImage"}],"title":"NSImage","kind":"symbol","type":"topic","navigatorTitle":[{"text":"NSImage","kind":"identifier"}],"url":"\/documentation\/fzuikit\/appkit\/nsimage","identifier":"doc:\/\/FZUIKit\/documentation\/FZUIKit\/AppKit\/NSImage","abstract":[]},"doc://FZUIKit/documentation/FZUIKit/AppKit/NSImage/preparingForDisplay()":{"type":"topic","identifier":"doc:\/\/FZUIKit\/documentation\/FZUIKit\/AppKit\/NSImage\/preparingForDisplay()","fragments":[{"text":"func","kind":"keyword"},{"kind":"text","text":" "},{"text":"preparingForDisplay","kind":"identifier"},{"kind":"text","text":"() -> "},{"text":"NSImage","preciseIdentifier":"c:objc(cs)NSImage","kind":"typeIdentifier"},{"kind":"text","text":"?"}],"role":"symbol","url":"\/documentation\/fzuikit\/appkit\/nsimage\/preparingfordisplay()","title":"preparingForDisplay()","kind":"symbol","abstract":[{"text":"Decodes an image synchronously and provides a new one for display in views and animations.","type":"text"}]}}}